domain: wealth
description: >
  Multi-currency wealth management for Non-Resident Indians (NRIs).
  Covers risk profiling, portfolio analysis, and AI-guided allocation
  across INR, USD, AED, GBP holdings.

skills:
  - name: risk-assess
    role: specialist
    trigger: manual
    model: anthropic/claude-sonnet-4-5-20250929
    cost_budget_per_execution: "$0.05"
    timeout: 30s

  - name: portfolio-check
    role: specialist
    trigger: manual
    model: anthropic/claude-sonnet-4-5-20250929
    cost_budget_per_execution: "$0.08"
    timeout: 45s

  - name: suggest-allocation
    role: specialist
    trigger: routed
    model: anthropic/claude-sonnet-4-5-20250929
    cost_budget_per_execution: "$0.12"
    timeout: 60s

routing:
  - from: risk-assess
    to: suggest-allocation
    condition: output_match("risk_profile != null")
    context_pass:
      - risk_profile
      - investment_horizon
      - monthly_surplus

  - from: portfolio-check
    to: suggest-allocation
    condition: output_match("rebalance_needed == true")
    context_pass:
      - current_allocation
      - target_allocation
      - drift_percentage

guardrails:
  max_cost_per_session: "$1.00"
  max_skills_per_session: 10
  require_human_approval:
    - action: "place_order"
      threshold: "$5000"
    - action: "rebalance_execute"
      threshold: "$10000"
  blocked_actions:
    - "withdraw_funds"
    - "close_account"
    - "transfer_to_unknown_beneficiary"

observability:
  log_level: info
  trace_provider: langfuse
  metrics:
    - name: skill_execution_duration_seconds
      type: histogram
      labels: [skill_name, model, outcome]
    - name: portfolio_value_at_check
      type: gauge
      labels: [currency, asset_class]
    - name: allocation_drift_percentage
      type: gauge
      labels: [asset_class]

feedback:
  capture_corrections: true
  correction_store: episodic_memory
  auto_generate_tests: true
  test_framework: deepeval
  reflexion_enabled: true

mcp_tools:
  - name: market-data
    description: "Real-time and historical market data (NSE, NYSE, Gold, FX)"
    server: market-data-mcp
    tools:
      - get_quote
      - get_history
      - get_fx_rate
  - name: portfolio-store
    description: "User portfolio holdings and goals"
    server: portfolio-mcp
    tools:
      - get_holdings
      - get_goals
      - update_allocation
